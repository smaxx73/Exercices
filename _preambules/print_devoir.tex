\newboolean{solution}
\newboolean{uuid}
\newboolean{link}


\newcounter{num}

\definecolor{solutioncolor}{RGB}{0,100,0}
\definecolor{titrecolor}{RGB}{36,76,146}

%liens vers des ressources extérieures :
\newcommand{\pathcorrige}{https://raw.githubusercontent.com/smaxx73/Exercices/main/pdf/pdf/}
\newcommand{\pathnotebook}{https://github.com/smaxx73/Exercices/blob/main/notebook/}
\newcommand{\pathexercice}{https://raw.githubusercontent.com/smaxx73/Exercices/main/pdf/pdf_sansol/}

\newtcolorbox{marker}[1][]{enhanced,hbox,before skip=2mm,after skip=3mm,fontupper=\small\sffamily,%
	boxrule=0.4pt,left=1mm,right=4mm,top=1pt,bottom=1pt,colback=blue!15,colframe=yellow!20!black,%
	sharp corners,rounded corners=southeast,arc is angular,arc=3mm,%
	underlay={%
		\path[fill=tcbcolback!80!black] ([yshift=3mm]interior.south east)--++(-0.4,-0.1)--++(0.1,-0.2);
		\path[draw=tcbcolframe,shorten <=-0.05mm,shorten >=-0.05mm] ([yshift=3mm]interior.south east)--++(-0.4,-0.1)--++(0.1,-0.2);
		%\path[fill=yellow!50!black,draw=none] (interior.south west) rectangle node[midway,white]{\Large\bfseries{}!} ([xshift=3mm]interior.north west);
	},%
	drop fuzzy shadow,#1
}

\newtcolorbox{solutionbox}{
	enhanced,
	breakable,
	colback=solutioncolor!30!white,
	colframe=solutioncolor,
	boxsep=5pt,
	%arc=4pt,
	%borderline={0.8pt}{-3pt}{solutioncolor},
	frame hidden,
	interior style={top color=solutioncolor!15!white, bottom color=solutioncolor!20!white},
	overlay={
		\node[anchor=north west, inner sep=0pt] at (frame.north west) {\tikz{\node[draw, fill=solutioncolor, inner sep=1pt] {\textcolor{white}\checkmark};}};
	} % Ajouter l'icône d'ampoule en tant qu'overlay
}

\newtcolorbox{titrebox}[3][]{
	enhanced,
	breakable,
	boxrule=0pt,
	colframe=white,
	colback=white,
	sharp corners,
	top=20pt,
	borderline north={1pt}{0pt}{gray!50},
	overlay unbroken and first={
		\node[anchor=west, inner xsep=0pt, inner ysep=5pt, minimum width=\linewidth-2mm, text width=\linewidth-2mm, text depth=1ex, text height=1.5ex, text=black] at ([yshift=2mm]frame.north west) {
			\small\textbf{\sffamily{\textcolor{black}{Ex #1 - #2}}}
		};
		\ifthenelse{\boolean{uuid}}{
			\node[anchor=east, inner ysep=5pt, inner xsep=5pt] at ([yshift=2mm]frame.north east) {
				\ifthenelse{\boolean{link}}{\href{\pathcorrige#3.pdf}{\texttt{#3}}}{\texttt{#3}}
			};
		}{};
	},
}

\newtcolorbox{titreboxbis}[3][]{
	enhanced,
	breakable,
	boxrule=0pt,
	colframe=white,
	colback=white,
	sharp corners,
	top=20pt,
	borderline north={1pt}{0pt}{gray!50},
	overlay unbroken and first={
		\node[anchor=west, inner xsep=0pt, inner ysep=5pt, minimum width=\linewidth-2mm, text width=\linewidth-2mm, text depth=1ex, text height=1.5ex, text=black] at ([yshift=2mm]frame.north west) {
			\small\textbf{\sffamily{\textcolor{black}{Partie #1 - #2}}}
		};
		\ifthenelse{\boolean{uuid}}{
			\node[anchor=east, inner ysep=5pt, inner xsep=5pt] at ([yshift=2mm]frame.north east) {
				\ifthenelse{\boolean{link}}{\href{\pathcorrige#3.pdf}{\texttt{#3}}}{\texttt{#3}}
			};
		}{};
	},
}





\newcommand{\titre}[1]{%
	\def\TitreExo{#1}
}
\newcommand{\contenu}[1]{%
	\def\Contenu{#1}
}

\newcommand{\code}[1]{#1}
\newcommand{\texte}[1]{#1}
\newcommand{\theme}[1]{}
\newcommand{\auteur}[1]{}
\newcommand{\organisation}[1]{}
\newcommand{\question}[1]{#1}
\newcommand{\reponse}[1]{
	\ifthenelse{\boolean{solution}} 
	{%
		\begin{solutionbox}
			\begin{footnotesize} #1 \end{footnotesize} 
	\end{solutionbox}}{}
} 

\newcommand{\nextexo}{
	\addtocounter{num}{1}
	\vspace{1em}
}

% \newcommand{\insertexo}[1]{
% \begin{minipage}[t]{0.85\textwidth}
%\input{../Exercices/#1}
%\end{minipage}
%\begin{minipage}[t]{0.15\textwidth}
%{\tiny [#1]}
%\end{minipage}
%}

\newcommand{\insertexobis}[5]{%contenu, solution, uuid, lien solution,numerotation,theme
	\noindent
	\input{\path src/#1}
	\setboolean{solution}{#2}
	\setboolean{uuid}{#3}
	\setboolean{link}{#4}
	
	\begin{titreboxbis}[#5]
		{\bfseries{\TitreExo}}{#1} %\hfill
		%\hfill \ifthenelse{\boolean{link}}{\qrcode{\pathcorrige#1.pdf}}{\phantom{\qrcode{\pathcorrige#1.pdf}}}
		\Contenu
	\end{titreboxbis}	
}


\newcommand{\insertexo}[5]{%contenu, solution, uuid, lien solution,numerotation,theme
	\noindent
	\input{\path src/#1}
	\setboolean{solution}{#2}
	\setboolean{uuid}{#3}
	\setboolean{link}{#4}
	
	\begin{titrebox}[#5]
		{\bfseries{\TitreExo}}{#1} %\hfill
		%\hfill \ifthenelse{\boolean{link}}{\qrcode{\pathcorrige#1.pdf}}{\phantom{\qrcode{\pathcorrige#1.pdf}}}
		\Contenu
	\end{titrebox}	
}

\newcommand{\listexo}[1]{%liste
	\foreach \ex in #1 {
		\nextexo
		\insertexobis{\ex}{\solution}{\uuid}{\link}{\thenum}
	}
}

\newcommand{\insertnotebook}[1]{%contenu, solution, uuid, lien solution,numerotation
	\href{\pathnotebook#1.ipynb}{Lien vers le notebook} 
}

\newcommand{\colonnes}[3]{
	\setboolean{solution}{#1}
	\ifthenelse{\boolean{solution}} {
		\ifnumcomp{#3}{=}{1}
		{}%
		{\begin{multicols}{#3}}%
		}%
		{%
			\ifnumcomp{#2}{=}{1}
			{}%
			{\begin{multicols}{#2}}%
			}
		}
		
\newcommand{\fincolonnes}[3]{
			\setboolean{solution}{#1}
			\ifthenelse{\boolean{solution}} {
				\ifnumcomp{#3}{=}{1}
				{}%
				{\end{multicols}}%
		}%
		{%
			\ifnumcomp{#2}{=}{1}
			{}%
			{\end{multicols}}%
	}
}

\newcounter{qrcodenum}

\newcommand{\listeqrcode}[2]{%liste d'exercices, initiatialisation du compteur
\setcounter{qrcodenum}{#2}
\noindent
\foreach \exo in #1{
	% Crée une minipage pour chaque exercice avec son numéro, son titre et son QR code
	\begin{minipage}{0.24\textwidth}  % ajustez la largeur pour avoir 4 QR codes par ligne
		\centering
		\href{\pathcorrige\exo.pdf}{\texttt{Ex \theqrcodenum : \exo \vspace{1em}}}  % affiche le numéro et le titre de l'exercice
		{\qrcode{\pathcorrige\exo.pdf}}  % génère le QR code
		\par\vspace{2em}  % espace vertical entre les QR codes
	\end{minipage}
	% Incrémente le compteur
	\stepcounter{qrcodenum}
}
}